# AGENT_GUIDE.md for PROV Ontology

## Overview

The PROV (Provenance) ontology captures the origin, derivation, and history of resources. It describes how entities were produced, what activities generated them, and which agents were responsible, enabling comprehensive tracking of data lineage and accountability chains.

## Core Classes

### Starting Point Classes

**`<http://www.w3.org/ns/prov#Entity>`**
- Physical, digital, conceptual, or other things with fixed aspects
- Use when: Tracking any resource whose provenance you need to record (documents, datasets, etc.)

**`<http://www.w3.org/ns/prov#Activity>`**  
- Something that occurs over time and acts upon entities
- Use when: Describing processes, computations, or events that transform entities

**`<http://www.w3.org/ns/prov#Agent>`**
- Something that bears responsibility for activities or entities
- Use when: Identifying who/what is accountable for provenance events

### Specialized Agent Types

**`<http://www.w3.org/ns/prov#Person>`**
- Human agents
- Use when: Recording human responsibility or authorship

**`<http://www.w3.org/ns/prov#Organization>`**
- Institutional agents like companies or societies  
- Use when: Tracking organizational responsibility

**`<http://www.w3.org/ns/prov#SoftwareAgent>`**
- Software systems or programs
- Use when: Recording automated processes or software-generated content

### Specialized Entity Types

**`<http://www.w3.org/ns/prov#Collection>`**
- Entities that provide structure to constituent entities
- Use when: Modeling datasets, lists, or other structured aggregations

**`<http://www.w3.org/ns/prov#Bundle>`**
- Named set of provenance descriptions, itself an entity
- Use when: Packaging provenance information as a reusable unit

## Key Properties

### Core Relationships

**`<http://www.w3.org/ns/prov#wasGeneratedBy>`**
- Domain: Entity | Range: Activity
- Usage: `?entity prov:wasGeneratedBy ?activity`

**`<http://www.w3.org/ns/prov#used>`**
- Domain: Activity | Range: Entity  
- Usage: `?activity prov:used ?entity`

**`<http://www.w3.org/ns/prov#wasAssociatedWith>`**
- Domain: Activity | Range: Agent
- Usage: `?activity prov:wasAssociatedWith ?agent`

**`<http://www.w3.org/ns/prov#wasAttributedTo>`**
- Domain: Entity | Range: Agent
- Usage: `?entity prov:wasAttributedTo ?agent`

### Derivation Relationships

**`<http://www.w3.org/ns/prov#wasDerivedFrom>`**
- Domain: Entity | Range: Entity
- Usage: `?derivedEntity prov:wasDerivedFrom ?sourceEntity`

**`<http://www.w3.org/ns/prov#wasRevisionOf>`**
- Domain: Entity | Range: Entity  
- Usage: `?newVersion prov:wasRevisionOf ?oldVersion`

### Temporal Properties

**`<http://www.w3.org/ns/prov#generatedAtTime>`**
- Domain: Entity | Range: xsd:dateTime
- Usage: `?entity prov:generatedAtTime ?timestamp`

**`<http://www.w3.org/ns/prov#startedAtTime>`**
- Domain: Activity | Range: xsd:dateTime
- Usage: `?activity prov:startedAtTime ?timestamp`

## Query Patterns

### Finding All Entities Generated by a Specific Activity

```sparql
PREFIX prov: <http://www.w3.org/ns/prov#>

SELECT ?entity WHERE {
  ?entity prov:wasGeneratedBy <http://example.org/activity1> .
}
```

### Tracing Entity Derivation Chain

```sparql
PREFIX prov: <http://www.w3.org/ns/prov#>

SELECT ?entity ?source WHERE {
  <http://example.org/entity1> prov:wasDerivedFrom* ?entity .
  OPTIONAL { ?entity prov:wasDerivedFrom ?source }
}
```

### Finding All Agents Responsible for an Entity (Direct and Indirect)

```sparql
PREFIX prov: <http://www.w3.org/ns/prov#>

SELECT DISTINCT ?agent WHERE {
  {
    <http://example.org/entity1> prov:wasAttributedTo ?agent .
  } UNION {
    <http://example.org/entity1> prov:wasGeneratedBy ?activity .
    ?activity prov:wasAssociatedWith ?agent .
  }
}
```

### Activity Timeline with Used/Generated Entities

```sparql
PREFIX prov: <http://www.w3.org/ns/prov#>

SELECT ?activity ?startTime ?endTime ?usedEntity ?generatedEntity WHERE {
  ?activity a prov:Activity .
  OPTIONAL { ?activity prov:startedAtTime ?startTime }
  OPTIONAL { ?activity prov:endedAtTime ?endTime }
  OPTIONAL { ?activity prov:used ?usedEntity }
  OPTIONAL { ?generatedEntity prov:wasGeneratedBy ?activity }
}
ORDER BY ?startTime
```

### Complete Provenance Graph for an Entity

```sparql
PREFIX prov: <http://www.w3.org/ns/prov#>

CONSTRUCT {
  ?s ?p ?o
} WHERE {
  {
    <http://example.org/entity1> prov:wasDerivedFrom* ?entity .
    ?entity ?p ?o .
    FILTER(STRSTARTS(STR(?p), "http://www.w3.org/ns/prov#"))
  } UNION {
    <http://example.org/entity1> prov:wasDerivedFrom* ?entity .
    ?entity prov:wasGeneratedBy ?activity .
    ?activity ?p ?o .
    FILTER(STRSTARTS(STR(?p), "http://www.w3.org/ns/prov#"))
  }
}
```

## Important Considerations

- **Qualified vs Unqualified Forms**: PROV provides both simple binary relations (e.g., `wasGeneratedBy`) and qualified forms with additional context (e.g., `qualifiedGeneration`). Use qualified forms when you need to attach additional metadata like roles or timestamps.

- **Temporal Ordering**: Activities have duration (`startedAtTime`/`endedAtTime`) while instantaneous events use `atTime`. Generation/usage/invalidation events occur at specific instants.

- **Inverse Properties**: Some inverse properties are explicitly defined (e.g., `generated` inverse of `wasGeneratedBy`) while others are only documented via annotations. Check property definitions carefully.

- **Entity Mutability**: Entities in PROV have fixed aspects - use new entity URIs for changed states and link with derivation relationships.

- **Agent Hierarchy**: The three agent types (Person, Organization, SoftwareAgent) are disjoint - an agent cannot be multiple types simultaneously.

## Quick Reference

**Core Namespace**: `http://www.w3.org/ns/prov#`

**Essential Classes**:
- `prov:Entity` - Things with provenance
- `prov:Activity` - Processes that transform entities  
- `prov:Agent` - Responsible parties

**Key Properties**:
- `prov:wasGeneratedBy` - Entity ← Activity
- `prov:used` - Activity → Entity
- `prov:wasAttributedTo` - Entity → Agent  
- `prov:wasAssociatedWith` - Activity → Agent
- `prov:wasDerivedFrom` - Entity → Entity

**Time Properties**:
- `prov:generatedAtTime`, `prov:startedAtTime`, `prov:endedAtTime`