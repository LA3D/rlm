# PROV Ontology Agent Guide

## Overview

The PROV Ontology (PROV-O) is the W3C standard for representing and interchanging provenance information. Provenance describes the origins, history, and lineage of data and processes - essentially answering "where did this come from?" and "how was this created?"

**Use PROV when you need to:**
- Track data lineage and transformation history
- Record responsibility and attribution for digital artifacts
- Document workflow execution and dependencies
- Ensure reproducibility and trust in data processing
- Comply with data governance requirements

## Core Classes

### 1. Entity (`prov:Entity`)
**What it is:** Physical, digital, conceptual, or other things with some fixed aspects
**When to use:** For any data, document, file, dataset, or artifact you want to track
**Examples:**
```turtle
:dataset_v1 a prov:Entity ;
    rdfs:label "Customer Database v1.0" .

:report.pdf a prov:Entity ;
    rdfs:label "Monthly Sales Report" .
```

### 2. Activity (`prov:Activity`) 
**What it is:** Something that occurs over time and acts upon or with entities
**When to use:** For processes, computations, transformations, or any action that creates/modifies entities
**Examples:**
```turtle
:data_cleaning a prov:Activity ;
    rdfs:label "Data Cleaning Process" ;
    prov:startedAtTime "2024-01-15T09:00:00Z"^^xsd:dateTime ;
    prov:endedAtTime "2024-01-15T11:30:00Z"^^xsd:dateTime .
```

### 3. Agent (`prov:Agent`)
**What it is:** Something that bears responsibility for activities, entities, or other agents
**When to use:** For people, organizations, software systems, or services that perform actions
**Examples:**
```turtle
:john_doe a prov:Agent, prov:Person ;
    rdfs:label "John Doe" ;
    foaf:mbox "john@example.com" .

:etl_system a prov:Agent, prov:SoftwareAgent ;
    rdfs:label "ETL Processing System v2.1" .
```

## Key Properties

### Starting-Point Properties (Core Relationships)

#### `prov:wasGeneratedBy`
- **Domain:** Entity → **Range:** Activity  
- **Use:** When an entity was created/produced by an activity
```turtle
:clean_dataset prov:wasGeneratedBy :data_cleaning .
```

#### `prov:used`
- **Domain:** Activity → **Range:** Entity
- **Use:** When an activity consumed/used an entity as input
```turtle
:data_cleaning prov:used :raw_dataset .
```

#### `prov:wasAssociatedWith`
- **Domain:** Activity → **Range:** Agent
- **Use:** When an agent was responsible for an activity
```turtle
:data_cleaning prov:wasAssociatedWith :john_doe .
```

#### `prov:wasAttributedTo`
- **Domain:** Entity → **Range:** Agent  
- **Use:** When an agent is responsible for an entity's existence
```turtle
:report.pdf prov:wasAttributedTo :john_doe .
```

#### `prov:wasDerivedFrom`
- **Domain:** Entity → **Range:** Entity
- **Use:** When one entity was derived from another
```turtle
:summary_report prov:wasDerivedFrom :detailed_data .
```

### Temporal Properties
- `prov:startedAtTime` / `prov:endedAtTime` - Activity timing
- `prov:generatedAtTime` - When entity was generated
- `prov:invalidatedAtTime` - When entity became invalid

### Qualified Forms
Every starting-point property has a qualified form for additional details:
```turtle
:report prov:wasGeneratedBy :analysis ;
    prov:qualifiedGeneration [
        a prov:Generation ;
        prov:activity :analysis ;
        prov:atTime "2024-01-15T14:30:00Z"^^xsd:dateTime ;
        :confidence "high" 
    ] .
```

## Query Patterns

### 1. Find all entities generated by an activity
```sparql
SELECT ?entity WHERE {
    ?entity prov:wasGeneratedBy :my_activity .
}
```

### 2. Trace entity lineage (what was this derived from?)
```sparql
SELECT ?source WHERE {
    :my_entity prov:wasDerivedFrom+ ?source .
}
```

### 3. Find who was responsible for creating an entity
```sparql
SELECT ?agent WHERE {
    :my_entity prov:wasAttributedTo ?agent .
}
# OR through activity
SELECT ?agent WHERE {
    :my_entity prov:wasGeneratedBy ?activity .
    ?activity prov:wasAssociatedWith ?agent .
}
```

### 4. Get complete provenance chain
```sparql
SELECT ?entity ?activity ?agent ?time WHERE {
    ?entity prov:wasGeneratedBy ?activity .
    ?activity prov:wasAssociatedWith ?agent .
    OPTIONAL { ?activity prov:startedAtTime ?time }
}
```

### 5. Find all activities an agent performed
```sparql
SELECT ?activity WHERE {
    ?activity prov:wasAssociatedWith :john_doe .
}
```

## Important Considerations

### 1. Disjoint Classes
- Entity and Activity are disjoint - something cannot be both
- Choose carefully: is it a thing (Entity) or a process (Activity)?

### 2. Qualified vs Unqualified Forms
- Use simple properties (e.g., `prov:wasGeneratedBy`) for basic relationships
- Use qualified forms when you need additional metadata (time, location, confidence, etc.)

### 3. Inverse Properties
- Every major property has an inverse: `wasGeneratedBy` ↔ `generated`
- Choose the direction that makes most sense for your queries

### 4. Time Handling
- Activities have start/end times
- Entities have generation/invalidation times
- Use proper XSD datetime formatting

### 5. Agent Types
- `prov:Person` - Human agents
- `prov:Organization` - Organizational agents  
- `prov:SoftwareAgent` - Software/system agents

### 6. Collections and Bundles
- Use `prov:Collection` for sets of entities
- Use `prov:Bundle` for provenance records themselves

## Quick Reference

### Essential Classes
```turtle
prov:Entity      # Things with fixed aspects
prov:Activity    # Processes that occur over time  
prov:Agent       # Responsible parties
```

### Essential Properties
```turtle
# Core relationships
prov:wasGeneratedBy    # Entity ← Activity
prov:used             # Activity → Entity  
prov:wasAssociatedWith # Activity → Agent
prov:wasAttributedTo   # Entity → Agent
prov:wasDerivedFrom    # Entity → Entity

# Timing
prov:startedAtTime / prov:endedAtTime
prov:generatedAtTime / prov:invalidatedAtTime

# Qualification
prov:qualifiedGeneration / prov:qualifiedUsage / etc.
```

### Common Patterns
```turtle
# Basic provenance
:output prov:wasGeneratedBy :process .
:process prov:used :input ;
         prov:wasAssociatedWith :agent .

# With timing
:process prov:startedAtTime "2024-01-15T09:00:00Z"^^xsd:dateTime .

# With qualification  
:output prov:qualifiedGeneration [
    a prov:Generation ;
    prov:activity :process ;
    prov:atTime "2024-01-15T10:30:00Z"^^xsd:dateTime
] .
```