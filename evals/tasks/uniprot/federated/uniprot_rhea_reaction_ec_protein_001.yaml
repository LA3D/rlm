# Eval Task: Rhea â†’ UniProt Federated - (reaction, ec, protein) for a given Rhea reaction
# Source exemplar: ontology/uniprot/examples/Rhea/110_Select_reaction_ec_protein_for_a_given_reaction.ttl

task:
  id: "uniprot_rhea_reaction_ec_protein_001"
  category: "uniprot/federated"
  difficulty: "hard"

  query: "For a given Rhea reaction, retrieve the EC and reviewed UniProt proteins (federated from Rhea to UniProt)."

  context:
    ontologies:
      - name: uniprot_core
        source: ontology/uniprot/core.ttl
    sparql:
      endpoint: "https://sparql.rhea-db.org/sparql"
      prefixes: "ontology/uniprot/examples/prefixes.ttl"
      exemplar: "ontology/uniprot/examples/Rhea/110_Select_reaction_ec_protein_for_a_given_reaction.ttl"

  # Expected patterns from exemplar (for LLM judge context, not strict requirements)
  exemplar_patterns:
    - "PREFIX rh:"
    - "PREFIX ec:"
    - "PREFIX up:"
    - "rh:ec ?enzyme"
    - "SERVICE <http://sparql.uniprot.org/sparql>"
    - "up:reviewed true"
    - "OPTIONAL { ?protein up:enzyme ?enzyme }"

  graders:
    - type: convergence
      max_iterations: 12
    - type: sparql_structural
      # Federation is the learning objective
      requires_service: ["sparql.uniprot.org"]
    - type: outcome_verification
      # Verify results contain reaction, EC, and protein data
      result_type: "present"
      min_results: 1
      required_fields: ["ec", "protein"]
    - type: llm_judge
      # LLM evaluates federation approach and semantic correctness
      use_exemplar_patterns: true
      strict: false
    - type: tool_called
      required: ["sparql_query"]

  trials: 3

