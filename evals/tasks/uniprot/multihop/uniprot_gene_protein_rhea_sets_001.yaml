# Eval Task: UniProt Multi-hop - Gene → Protein → Catalyzed Rhea reaction sets
# Source exemplar: ontology/uniprot/examples/UniProt/61_Gene_Protein_Reaction_sets.ttl

task:
  id: "uniprot_gene_protein_rhea_sets_001"
  category: "uniprot/multihop"
  difficulty: "hard"

  query: "For human reviewed proteins, return Ensembl gene → UniProtKB protein → catalyzed Rhea reaction."

  context:
    ontologies:
      - name: uniprot_core
        source: ontology/uniprot/core.ttl
    sparql:
      endpoint: "https://sparql.uniprot.org/sparql/"
      prefixes: "ontology/uniprot/examples/prefixes.ttl"
      exemplar: "ontology/uniprot/examples/UniProt/61_Gene_Protein_Reaction_sets.ttl"

  # Expected patterns from exemplar (for LLM judge context, not strict requirements)
  exemplar_patterns:
    - "PREFIX up:"
    - "PREFIX taxon:"
    - "up:reviewed true"
    - "up:organism taxon:9606"  # Human
    - "up:catalyticActivity"
    - "up:catalyzedReaction"
    - "rdfs:seeAlso ?ensemblTranscript"
    - "up:transcribedFrom ?ensemblGene"
    - "DISTINCT"  # To avoid duplicates from multiple transcripts

  graders:
    - type: convergence
      max_iterations: 12
    - type: outcome_verification
      # Verify results contain gene-protein-reaction chains
      result_type: "present"
      min_results: 1
      required_fields: ["gene", "protein", "reaction"]
    - type: llm_judge
      # LLM evaluates multi-hop query correctness and relationship chains
      use_exemplar_patterns: true
      strict: false
    - type: tool_called
      required: ["sparql_query"]

  trials: 3

