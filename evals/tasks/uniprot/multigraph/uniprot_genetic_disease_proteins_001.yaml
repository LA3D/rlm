# Eval Task: UniProt Multi-graph - Genetic disease related proteins
# Source exemplar: ontology/uniprot/examples/UniProt/78_genetic_disease_related_proteins.ttl

task:
  id: "uniprot_genetic_disease_proteins_001"
  category: "uniprot/multigraph"
  difficulty: "medium"

  query: "List UniProtKB proteins related to a genetic disease, including disease comment and optional MIM cross-reference."

  context:
    ontologies:
      - name: uniprot_core
        source: ontology/uniprot/core.ttl
    sparql:
      endpoint: "https://sparql.uniprot.org/sparql/"
      prefixes: "ontology/uniprot/examples/prefixes.ttl"
      exemplar: "ontology/uniprot/examples/UniProt/78_genetic_disease_related_proteins.ttl"

  # Expected patterns from exemplar (for LLM judge context, not strict requirements)
  exemplar_patterns:
    - "PREFIX up:"
    - "GRAPH <http://sparql.uniprot.org/uniprot>"
    - "GRAPH <http://sparql.uniprot.org/diseases>"
    - "up:annotation ?diseaseAnnotation"
    - "up:disease"
    - "OPTIONAL { ... rdfs:seeAlso ?mim }"

  graders:
    - type: convergence
      max_iterations: 16  # Increased from 10 (task ran 11 iterations)
    - type: sparql_structural
      # Named graph joins are the learning objective for this task
      requires_graph: true
      required_patterns: ["up:disease"]
    - type: outcome_verification
      # Verify results contain disease-related proteins
      result_type: "present"
      min_results: 3
      required_fields: ["protein", "disease"]
      verification_patterns:
        # Proteins are UniProt URIs
        - field: "protein"
          pattern: "uniprot.org/uniprot/"
          matches: "all"
    - type: llm_judge
      # LLM evaluates semantic correctness and graph join approach
      use_exemplar_patterns: true
      strict: false
    - type: tool_called
      required: ["sparql_query"]

  trials: 3

